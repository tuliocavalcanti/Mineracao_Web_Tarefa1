Inferring Networked Device Categories from Low-Level
Activity Indicators
Kyumars Sheykh Esmaili
Nokia Bell Labs
Antwerp, Belgium
Jaideep Chandrashekar
Technicolor R&I
Los Altos, CA
Pascal Le Guyadec
Technicolor R&I
Rennes, France
ABSTRACT
We study the problem of inferring the type of a networked
device in a home network by leveraging low level traffic ac-
tivity indicators seen at commodity home gateways. We an-
alyze a dataset of detailed device network activity obtained
from 240 subscriber homes of a large European ISP and ex-
tract a number of traffic and spatial fingerprints for individ-
ual devices. We develop a two level taxonomy to describe
devices onto which we map individual devices using a num-
ber of heuristics. We leverage the heuristically derived la-
bels to train classifiers that distinguish device classes based
on the traffic and spatial fingerprints of a device. Our results
show an accuracy level up to 91% for the coarse level cate-
gory and up to 84% for the fine grained category. By incor-
porating information from other sources (e.g., MAC OUI),
we are able to further improve accuracy to above 97% and
92%, respectively. Finally, we also extract a set of simple
and human-readable rules that concisely capture the behav-
ior of these distinct device categories.
1. INTRODUCTION
To a home Internet gateway (and the ISP operat-
ing the gateway), devices on a home network are rep-
resented by a MAC address (and perhaps a hostname).
Associating a higher level semantic to a device (smart-
phone, game console, smart meter) to devices benets
a wide range of scenarios. For example, this capability
will allow a ISP help-desk operator to quickly identify
the particular device (with MAC address) that a cus-
tomer is complaining about; an ISP could better target
particular broadband or other service oerings to sub-
scribers by proling the devices used; an ISP subscriber
can set-up trac policies for their home network more
expressively (prioritize trac from game consoles), and
so on. Such a capability is particularly relevant today
given the proliferation of networked devices that are
growing the Internet-of-Things (weighing scales, smart
meters, thermostats, etc.). In this paper, we investigate
device classication from the point of view of a home In-
ternet gateway (and the ISP). To this end, we analyze a
large dataset of device activity, extract a set of features
that allow us to dierentiate between dierent types of
devices (and to dierent extents) and apply known clas-
sication techniques to map individual devices to device
categories.
While there are a number of dierent approaches to
identifying device types, the vantage point (the home
gateway) and the interested entity (the ISP) present a
number of challenges and restrict the space of solutions.
A method that relies on packet inspection could reliably
uncover the device type (e.g., by examining HTTP U/A
strings). However, deep packet inspection is not viable
on most of today's resource constrained home gateways.
While ISPs could easily implement such a function up-
stream, they are very reluctant to do so due to consumer
privacy concerns [5]. Yet another method leverages the
fact that user's often assign descriptive names to their
devices (e.g., John-iPhone) which can be parsed to infer
the device type. Unfortunately, relatively few devices
in the home involve the conguration step (typically
personal devices) and the majority have default strings
which reveal little about the nature of the device (we
present data to support this later in the paper). Fi-
nally, one may look to exploit information in the MAC
OUI (which identies the device manufacturer). How-
ever, the discriminative power of the MAC OUI depends
greatly on the product range of a manufacturer and the
incidence of a manufacturer in a particular dataset. We
explore this issue in detail in a later section.
In this paper, we develop a systematic methodology
for accurately classifying devices based on their behavior
while on the home network. Our methodology is based
on measurements and metrics that are already available
today in commodity gateways deployed by all ISPs. The
underlying intuition is that the devices of a certain class
 say, tablets  are likely to be used by their owners in
similar ways and we expect their long term behavior
to be more similar to each other than devices from a
dierent category, for instance  laptops. For example
network extenders (which aggregate several devices be-
hind them) are likely to have higher trac volumes than
mobile devices or peripheral devices (e.g., printers).
Based on this intuition, we extract behavioral sig-
natures that capture a device's behavior along several
1
ar
X
iv
:1
70
9.
00
34
8v
1 
 [
cs
.N
I]
  1
 S
ep
 2
01
7
dimensions: how much trac it generates, how much it
moves, what is its daily usage? The signatures that we
construct for a device leverage common wisdom cap-
tured in previous work; we also develop a number of
novel behavior traits that are shown to have good dis-
criminative power. We develop a two level taxonomy of
device categories  a coarse grained device class and a
ner grained device type  based on an informal survey
of home network users. We then cast the problem of
identifying the device categor(ies) as a multi-class clas-
sication problem and present the results from applying
two well known classication methods  Decision Trees
and Support Vector Machines. While our dataset con-
tains both wired and wireless devices, the work is this
paper mainly focuses on wireless devices which consti-
tute the majority of the device population. However,
our methodology is general and may be applied across
the wider set of devices. The key contributions of this
paper are summarized as follows:
1. We explore in detail a large dataset of home network
activity taken from over 240 subscribers of an ISP for a
period of 1 year and which contains observations of over
5000 devices. We then identify and extract a number
of features, a number of which are identied based on
insights obtained from the data exploration, which cap-
ture trac and spatial behavior of individual devices.
2. We develop a two level taxonomy of common home
network devices that associates a device with a coarse
grained device class and a ner grained device type. We
then use a number of simple heuristics over the static
descriptors for a device to map each device onto the two
categories. We are able to obtain coarse grained labels
for 62% of the devices and ne-grained labels for 36%
of all devices in our dataset.
3. We study the performance of two well established
classication techniques  Decision trees and SVM  to
infer the labels for 1878 wirelessly connected devices.
We nd that the SVM based classier provides the best
classication accuracy and is 90.47% accurate on coarse
grained labels (83.11% for ne grained labels). Fur-
thermore, we explore the impact of incorporating other
information such as the MAC OUI and we show an
additional improvement of roughly 8-10% for the ne
grained labels, and 6% for the coarse grained labels.
We further examine the Decision Tree generated to un-
dersatnd the importance of particular features that in-
uence the type of a device.
The rest of this paper is structured as follows. In ?2,
we briey describe related work dierentiate them from
our contributions. In ?3, we describe the device dataset
used in this paper and in ?4, we present our device tax-
onomy and describe some heuristics that we apply to
extract labels for a subset of the devices. We discuss
feature extraction in detail in ?5 and explain the in-
tuition behind each of features extracted from the raw
metrics. In ?6, we introduce two classication meth-
ods and report on the results of applying these on our
dataset(s). in ?7, we conclude by discussing some open
issues and extensions.
2. RELATED WORK
In this paper, we study the problem of identifying the
type or class of a networked device, and disambiguating
between devices of dierent classes coexisting on the
same home network. While we are not aware of any
work in the literature that looks at this specic prob-
lem, there has been considerable work in closely related
areas  Trac & Application Inference, Device Disam-
biguation and Device Fingerprinting. We briey discuss
representative work in each.
Trac & Application Inference: A large body of
work has addressed the problem of determining the un-
derlying applications corresponding to trac ows ob-
served in the network. The high level intuition behind
all of these is that the dierences in application classes is
reected in the composition of trac and packets gen-
erated by these applications. For e.g., the graphical
relationships between source(s) and destinations(s) are
exploited to identify trac classes, as is described [14].
In another approach, an initial inference is improved
upon by incorporating more global information [12]. A
comprehensive survey of the techniques in this area can
be found in [20] and we highlight two other notable
works. In contrast to all of these, our work focuses on
identifying device classes.
Device Disambiguation: A number of previous ef-
forts have addressed the problem of distinguishing de-
vices behind a rewall or NAT device. For example,
Bellovin proposed a method to exploit IP header elds
to identify distinct hosts sharing a single IP address [2].
In [18], the authors describe an approach relying on the
IP TTL eld and HTTP user-agent strings to correctly
count and distinguish devices behind a single DSL line.
While these are applicable to a narrow part of our work
(identifying devices behind a non-transparent network
bridge, for instance), the data available to us is less se-
mantically rich (aggregated byte counters, in our case)
and thus these methods are not directly applicable.
Device Fingerprinting: There are two main approaches
to uniquely identifying devices (or software stacks, for
that matter). In the active approach, a set of crafted
packets is directed at a device/network interface and the
responses are analyzed to identify particular customiza-
tions or properties of the underlying code base  these
constitute a signature of the entity being ngerprinted.
This is the approach taken with some security scanners
(e.g., Nmap [21]), browser ngerprinting tools [7], or
wireless chipset [3]. In contrast, passive ngerprinting
methods attempt to extract unique signatures from sim-
ply observing the device interacting with the network.
2
This approach has been applied very successfully in the
past in ngerprinting wireless cards and chipsets [9,22],
or even devices [16]. Our own work diers from these in
that rather than extract unique ngerprints of a partic-
ular device or chipset, we seek to extract (behavioral)
signatures for a certain device type (which is greatly af-
fected by when, where and how often a device is used).
While some of the cited methods may be applicable in
general, our specic approach is dictated by the specic
nature of our dataset (which does not support any of
the other methods).
3. DATASET
Our work in this paper uses a dataset of over 5789
devices collected across 240 distinct homes over a year
(from 01/11/2013 to 01/10/2014). Here, we elaborate
how this dataset was collected and describe the recorded
metrics in detail. The 240 households captured in our
dataset were subscribers of a (single) large European
ISP during the period indicated and were recruited to
take part in a trial deployment. Home gateways in these
households were identical to all other subscribers ex-
cept in one aspect: gateways in the deployment period-
ically queried a set of software counters and state vari-
ables on the gateway and reported these to a back-end
server. The subscriber home gateways, spanning 4 dis-
tinct hardware models, were congured and provisioned
for a triple-play service (voice, broadband, IPTV) and
came with 4 physical Ethernet ports and a 802.11b/g/n
2x2 WiFi access point. Importantly, the WiFi access
point of every gateway in the trial was operational and
in use for the entire period.
3.1 Collected Raw Metrics
In the following, we enumerate and describe in de-
tail the particular set of recorded parameters that are
relevant to our work in this paper. We note that each
gateway observes all of the devices that were on the
home network at any point during the deployment and
thus our dataset is a complete record of all the network
activity across the 240 households during the period. If
there are any mobile cellular devices that are not cong-
ured to use the homeWiFi network (perhaps exclusively
using the cellular network), there is no record of it in
our dataset.
Host Descriptors: These correspond to the static
properties of individual devices that do not change over
time and include the following:
•MAC Address: the 48 bit address of the network in-
terface that is connected to the local area network. The
rst three octets of the MAC address (the OUI) identi-
es the vendor of the network interface. In most cases
 but not all  this also corresponds to the device man-
ufacturer.
•HostName: a descriptive string associated with a par-
ticular device, as recorded in the DHCP table of the
home gateway. In the case of many personal devices
 computers, phones, tablets, etc.,  users often select
descriptive, parse-able strings that can hint at the type
of device (and ownership). However, in the more com-
mon case, either the device self-selects a hostname or
else the gateway assigns a default hostname that incor-
porates the MAC address (to ensure it is unique).
•Physical Interface: describes the nature of the con-
nectivity to the gateway and is either wired (via one of
the 4 Ethernet ports on the gateway) or over WiFi.
The host descriptions do not change often and are
reported infrequently (every hour or so). In contrast
the dynamic variables and parameters that we discuss
next can change very frequently and are reported more
frequently by the gateway (roughly every minute).
Trac Volume Metrics: These report cumulative
trac volumes (in bytes) associated with particular (phys-
ical) gateway interfaces (for wired devices), or stations
(for wireless devices). We can compute the trac seen
between samples by computing successive dierences.
In the case of WiFi stations, trac records are indexed
by the MAC address of the station. We point out an
important artifact that is observed in our dataset. The
deployment covers 4 distinct trac models, and in the
case of all but one, the wired trac counters use 16
bits (and wrap around even with light trac). In these
cases, we are unable to accurately extract the trac
volumes associated with the devices connected on those
ports. While we do have some gateways that use 32 bit
counters, they are few in number. Due to the paucity
of trac data on the wired ports, we remove wired de-
vices from consideration and focus mainly on classifying
wireless devices  which are always associated with 32
bit counters.
Wireless Metrics: For the wireless station that is as-
sociated with the gateway, two additional metrics are
reported:
•Trac Rates: these are reports of the actual through-
put (sent and received bits per unit time) experienced
by each station associated with the gateway AP. Impor-
tantly, the gateway driver represents these as integer
values that are clipped to zero when the actual value is
less than 1 kbps. Note that this rate accounts for low
level management overhead on the wireless network (not
accounted for in the trac volume metric).
•RSSI: This captures the signal strength from the to
the gateway to the station. High(er) values typically
represent better coverage. Per station RSSI values are
computed at the gateway based on received data frames.
The actual value reported by the gateway is an average
value over all received packets in the reporting interval.
3
4. DEVICE TAXONOMY & LABELING
We polled 140 distinct subscriber households from
our dataset and asked them to enumerate all the var-
ious networked devices in their home (along with the
corresponding MAC address). We received results from
34 homes, which together named 137 devices. Table 2
presents a very small selection of these. The hostnames
indicated in the rst column were obtained by checking
the MAC addresses against the DHCP entries in the
dataset. The last column reects the user description
of the device. Based on our intuition from analyzing
this data, we constructed a two level taxonomy of de-
vice categories. The lower level  the ne-grained class
 captures how most users' identify their devices. At a
higher level, we also categorize the devices into coarse
grained classes which model how users relate to their
devices, how they use them, and how these devices be-
have on the network. We utilize the coarse grained la-
bels for two reasons. First, we see a gradual blending
of device functions as device form factors converge. For
example, the so called "phablet" form factors blur the
line between smartphones and tablets. Second, relying
purely on the ne grained classication results in a very
unbalanced data and poor results for under-represented
devices (in our dataset). Using a two level taxonomy
addresses both of these factors and this categorization
is presented in Table 1.
The rst row enumerates the coarse grained classes.
Compute devices are essentially laptops or desktops,
which are general purpose and used for a variety of tasks
by users (and sometimes shared between users). Mobile
Handheld devices are devices typically associated with
an individual and often carried on their person (or car-
ried around a home) and where the interaction periods
are shorter (than compute devices). Network Equip-
ment refers to devices that extend the range or function-
ality of a device, and typically aggregate the behavior
of several other devices placed behind them. Finally,
we have the Consumer Electronics (CE) category of
more specialized devices, which are built or optimized
for specic tasks or to consume particular services.
The second row enumerates all the ne-grained classes
inside of each coarse-grained category For example smart-
phones, tablets and eBook Readers all come under un-
der the high level categorization ofMobile Handheld de-
vices. With respect to the Compute Device class, we
do not dierentiate desktops and laptop computers. In
general, we do not expect signicant dierences in how
people use these devices. While a laptop may be used
in more than one location in a home (while a desktop
generally stays in a single location); we expect they are
both used the same way (as a general purpose compute
device) to do dierent things (check email, browse the
web, etc). Pragmatically, distinguishing these two is
that extracting ground truth labels are dicult; we ex-
plain this further in the next section. Finally, we have
devices such as printers/scanners, ISP supplied set-top-
boxes (STB), over-the-top (OTT) devices, and media or
game consoles, which are often designed to support one
particular use case. We point out that this categoriza-
tion is slightly arbitrary - several game consoles today
support video streaming (as do OTT boxes). This does
complicate the inference of the ne grained labels, the
coarse grained label inference is less sensitive. We also
note the ne grained categorization is not exhaustive
 we observe single instances of several device types
in our dataset (a smartwatch, a wireless smart-meter,
etc.). We ignore device types for which we observe less
than 3 instances in our dataset. In the following, we
describe a number of heuristics to infer the coarse and
ne grained labels for a device (as identied by its MAC
address); these heuristics are based on our intuition and
a careful exploration of the dataset.
4.1 Extracting “Ground Truth”
We developed a set of heuristics against the Host
Descriptors for all the devices in our dataset and this
yielded a smaller set of devices for which we believe the
inferred labels are accurate. We additionally veried
the heuristics against the 137 devices for which user
supplied labels and ensured that the heuristic inferred
labels are consistent with that supplied by users.
•Name Based Heuristics: Hostnames often contain
common descriptive strings, e.g., android, pc, iMac,
etc., which can be leveraged to infer the device's cate-
gory. Often, the descriptive strings are specic enough
to yield a ner grained categorization (e.g., john-iphone),
in which case we have both a coarse label (mobile hand-
held) as well as a ne grained label (smartphone). Some-
times, hostnames reect very specic device models (e.g.,
wrt54g  a home router manufactured by Linksys) or
take on factory default names that are well known (e.g.,
the ISP supplied STB is named identically across all the
homes it is deployed in). In such cases, we are able to
infer the nature of the device.
•MAC Address Renement: In some cases, the
MAC address of a device can be helpful in its iden-
tication, particularly when the vendor (identied by
the MAC OUI) manufactures has a very limited prod-
uct range (that may live in a home). One example:
the MAC OUI 00:00:48 is registered to Seiko Epson
corporation; it is likely that devices with this prex are
printers or scanners. However, the OUI is far less useful
in distinguishing devices in the case of vendors with di-
verse product portfolios. For instance, Apple Inc. man-
ufactures devices that span all of the coarse grained
categories in Table 1. Here, knowing that a device is
manufactured by Apple does not allow us to identify
the particular category. Yet another caveat in using
the MAC address is that it may be incorrect (on rare
4
Compute Mobile Networking CE
Device Hand-Held Equipment
Laptop/Desktop Smartphone PowLine Eth. Smart TV
Tablet WiFi Ext NAS
e-Reader Game Con-
sole
Media Bridge
OTT box
Printer/Scanner
Table 1: Device Categories
occasion): we saw one corner case where a vendor in-
correctly borrowed the mac OUI of a dierent manu-
facturer (this was also reported in [17]).
•BSSID based: Several printers and media bridge de-
vices allow WiFi-direct connections for which the device
temporarily advertises a network that uses the device's
MAC address (or an adjacent address) as the BSSID. In
some cases, the advertised SSIDs explicitly contain the
device model we are able to leverage these. We are able
to identify some wireless range extenders or network
bridges using the same technique.
•Other heuristics: We identied several instances in
the Host Descriptor data where a single MAC address is
associated with a number of hostnames (which are un-
related), and this occurs when several (potentially!) de-
vices are connected behind the network extender device.
When this count is greater than two, we tentatively la-
bel the device as a network extender. Then, we carry
out an additional check to verify if there are overlap-
ping sessions (distinct MAC addresses associated with
the same name sending/receiving trac at the same
time). If such behavior is found, we conrm that the
device is a network extender. We distinguish between
Powerline Ethernet connectors and WiFi Extenders by
comparing the set of hostnames against an exhaustive
set of models of each, and also leveraging the MAC OUI.
Finally, we present a census of all the devices that are
present in our dataset in Figure 1. We see host descrip-
tors for 5789 distinct mac addresses. Of these, 4234 are
associated with the wireless network, and the rest are
wired devices. Of the 1555 wired devices, only 676 are
observed on the gateways that use 32 bit trac coun-
ters. Further, of the remaining, only 153 devices were
found not to share the physical port with other devices
(which is essential to correctly attributing trac to the
device). Given this very small population (relative to
the whole), we omit wired devices from consideration in
the rest of this paper. Moving now to the devices seen
on the wireless network, we nd 1244 devices to be tran-
sient; that is, they are observed for very brief periods of
time on the network- the duration being insucient to
contribute sucient metrics to aid in classication (this
is further discussed in the data suciency experiments
in Section 6); we remove these from consideration. Fi-
nally, we are left with 2990 non-transient wireless de-
vices for which sucient data is available. However, we
Total MAC Addresses
5789
Wireless
4234
Wired
1555
32bit Counter
676NonTransient
2990
NonTransient
NotShared
153
CoarseLabels
1878
FineLabels
1089
DF
DC
Figure 1: Overall Dataset Summary
can establish the ground truth categorization only in
1878 instances for the coarse categories (denoted DC ),
and in 1089 cases with a ne grained label (denoted DF ).
Unless indicated otherwise, the results and analysis in
the paper pertains to the sets DC and DF . It should
be pointed out that our labeling is conservative. We
also implemented a number of sanity checks, for e.g., a
tablet or a smartphone cannot appear on a wired in-
terface without an extender present, an android phone
could not be manufactured by Apple, and so on). Any
discordance between the inferred labels and the sanity
check led to the label being rejected. By being conser-
vative, we are unable to categorize a large number of
devices in our dataset; however, we have a high degree
of condence in the extracted labels are accurate.
It should be clearly pointed out that the labeling that
we described in this section is only to obtain training
and testing data for the statistical classication meth-
ods (Section 6.1). It is unlikely that an ISP would
use these heuristics by themselves and this for two rea-
sons: (i) the heuristics described are unable to classify a
large number of devices, and (ii) there are potential pri-
vacy concerns with an ISP being able to read hostname
strings, which can sometimes contain names of people.
5. EXTRACTING FEATURES
In this section, we analyze the time series' of traf-
c and wireless metrics and subsequently construct a
number of features that are suitable to input to a clas-
sication framework. We use the term feature class to
describe a certain metric, possibly post processed, col-
lected from the gateways and from which a distribution
is constructed, and feature to refer to a specic attribute
extracted for that feature class. As an example, Daily
Trac Volume is a timeseries and a feature class, while
the median daily trac volume is a feature. In the fol-
lowing, we walk through each feature class and describe
how they are processed. In selecting these features, we
rely on a combination of common best practices and
also intuition obtained from initial explorations of the
dataset.
The complete set of 92 features that are associated
with each individual device is summarized in Table 3.
Table Table 3(a) enumerates feature classes while 3(b)
5
Hostnames Connecting Interface Category Sub-Category
1 user-iPhone WiFi Mobile hand-held Smartphone
2 iPad-user WiFi Mobile hand-held Tablet
3 user-toshiba-laptop Wired Compute Desktop/Laptop
4 PC Wi Compute Desktop/Laptop
5 TL-WA850RE Wired Network Eqpmt. WiFi Repeater
6 android-2013051200001053 WiFi Mobile hand-held unknown
7 RM4100 Wired Consumer STB
Table 2: Sample hostnames and ne grained labels obtained from survey (and the assigned coarse labels). The
device listed on row 6 was named "mobile" by the subscribers, which we consider a coarse grained label. Finally,
row 7 reects a well known naming convention used by the ISP for set top boxes.
represents the features extracted from each class. Fi-
nally, Table 3(c) describes 4 additional features that
are all extracted from the RSSI feature class.
Feature Class Subclasses
Daily tx
Trac Volume rx
Session Length session_l
Per Session session_tx
Trac Volume session_rx
Trac Rate
tx_rate
rx_rate
RSSI rssi
(a) Time series features
count
min
p10
p25 (Q1)
p50 (median)
p75 (Q3)
p90
max
p75-p25 (IQR)
p80-p20 (range80)
max-min (diameter)
(b) Dierent point-
summaries (11 in total)
used for each time series
Feature Name notation
Allan Deviation rssi_ad
M·D product rssi_md
# Locations rssi_num_locations
AuC rssi_auc
(c) Single-Point Features AuC indicates the area-under-curve cor-
responding to the empirical density function.
Table 3: All extracted features: (a) the feature
classes/subclasses that are in the form of time series,
(b) the 11 statistical point-summaries used for each time
series, (c) the single point (i.e., non-time series) features
5.1 Feature Classes
We rst describe all the feature classes that are con-
structed from trac (volume and rate) counters, and
subsequently describe the feature classes corresponding
to the RSSI data.
Trac-based Features
Daily Trac Volume: The amount of data (in bytes)
that a device transmits (or receives) each day that it was
active. Typically, we expect devices such as PCs, OTT
video streamers, or network extenders (which aggregate
trac for others) to have higher values for this feature
(in contrast to mobile hand-held devices).
Importantly, we also use this feature to distinguish
between transient and non-transient devices: a device
is non-transient if it has non-zero trac volume for at
least 3 days (setting this threshold is discussed in the
Results section) and transient otherwise1 . The rest of
this paper only considers devices that are non-transient.
Figure 2a depicts the median of medians of outgoing
(from the gateway to the device) daily trac for the
devices within each group (the incoming trac graphs
exhibit similar patterns). It shows that PCs and Net-
work Extenders consume the largest amount trac per
days.There is also a considerable dierence between Tablets
and Smartphones.
Session Length: The duration of time that a device
was active, i.e., generating trac, is computed as fol-
lows: sessions are initiated when the corresponding traf-
c counter is non-zero and terminated when there is no
trac activity for at least 15 minutes (this is the ARP
timeout value). Thus, for each device, we obtain a list of
sessions of the form (start time, end time). Intuitively,
we expect small hand-held devices to have shorter ses-
sions, but more of them, than xed devices such as com-
puters and set top boxes. The result is a time series of
session lengths for each device and from this, we con-
struct a distribution. Figure 2b depicts the distribution
of median session length across the various (coarse) de-
vice classes. Here, the distribution for mobile devices
(smartphones, tablets) reects shorter sessions than for
devices like OTT boxes, Network Extenders, or even
PCs (slightly).
Per Session Trac: is the cumulative trac volume as-
sociated with each distinct session for a device. To al-
low for fair comparisons across dierent sessions, we
normalize these volumes by the length of the session.
We then construct a distribution for each device with
these normalized values and extract all the previously
listed statistics as individual features. Figure 2c shows
the distribution of the median values for the normalized
session rates.
Trac Rate: We build a distribution over the trac
rate metrics obtained for wireless devices. Recall from
Section 3.1 that this rate only accounts for user traf-
c (ignoring the eect of wireless control trac) and
thus contains a large number of zeros. We nd that
the median trac rate across almost all the devices in
our dataset is zero. In fact, we expect this particular
1These could, for example, be visiting guests' devices that
have been connected to the home's AP.
6
Game
Console
Net.
Extender
OTT Box PC Printer/
Scanner
Smartphone Tablet
8
10
12
14
16
18
20
22
(a) tx_med_ln in DF
Game
Console
Net.
Extender
OTT Box PC Printer/
Scanner
Smartphone Tablet
6
7
8
9
10
11
12
13
14
(b) session_l_median in DF
Game
Console
Net.
Extender
OTT Box PC Printer/
Scanner
Smartphone Tablet
0
2
4
6
8
10
12
(c) session_tx_med_ln in DF
Figure 2: Samples of Trac based features across ne grained device classes
fact to help discriminate between device types  we ex-
pect devices such as computers to have short(er) runs of
zero values (generally when they're on, they are used)
as compared to mobile devices, where the device can
be on for long periods of time with only some minimal
activities. Similarly, we expect fewer zeros associated
with network extenders (which aggregate trac from
other devices).
Spatial and Mobility Features
The RSSI reported for each device (as recorded by
the gateway) loosely tracks the physical distance of the
device from the gateway [13,15,19]. For a given network
environment (and device), we expect that distances in-
crease as the RSSI increases. Thus, as a device is used
in dierent locations over time, the set of all RSSI mea-
surements constitutes a spatial signature and the short
term dierences in the RSSI captures the mobility pat-
tern of the device inside the home. With this intuition,
we extract a number of feature classes to capture this
aspect of the device behavior.
Raw RSSI: For each device, we construct a distribution
of the reported values based on the timeseries of the
raw RSSI values. From this, we extract all the typical
distribution related metrics as we do for the trac fea-
tures (max, median, iqr, etc). Note that we include the
minimum value of the distribution as a feature, since
it is not uniformly zero (across devices), unlike in the
trac scenario.
RSSI Diameter: This is computed as the dierence of
the extreme values in the RSSI distribution, i.e., the
max-min statistic. Note that this is not as useful for
the trac based features where the minimum values
across devices are generally zero. Figure 3a shows the
distribution of this feature across the coarse grained de-
vice classes. From the gure, the distribution for mo-
bile hand held devices is shifted slightly higher than
the other classes; this indicates that such devices have
higher portability, i.e., can be used in a wider spatial
range. RSSI M-D product: This feature is constructed
as the product of the RSSI Diameter (previous) with
the median value of the RSSI distribution. We include
this feature to amplify the dierences (in the individual
product terms) across the device classes.
RSSI Allan Deviation: Specic to the timeseries of RSSI
values X = {x1, x2, . . . , xn}, this is dened as
AD(X) =
???? 1
2(n? 1)
n?1?
i=1
(xi+1 ? xi)2
Allan Deviation (or AD, for short) captures the instan-
taneous variation for time-indexed data and was orig-
inally designed to study frequency stability in clocked
analog circuits [1]. Applied to the RSSI time series, the
allan deviation captures the short time scale mobility
of a device. We expect this to be high(er) for mobile
hand held devices as compared to laptops or other more
stationary devices. Fig. 4 shows the distribution of this
feature over the dierent device classes. In Fig. 4a,
we see that the distribution for mobile hand-helds is
pushed upwards; this is expected, since we expect these
devices to be carried by users as they move around and
this is captured in short-term variations in the observed
RSSI. In Fig. 4b, the distributions for smartphones and
tablets are quite dierent, with the former tending to
have higher AD values. Again, this is borne out by in-
tuition; a smartphone might be in a user's pocket and
connected to the network as they walk around the home.
Location Modes: This feature quanties the number of
modes in the rssi distribution. Intuitively, it captures
the number of locations inside a home, where the de-
vice is used most. By exploring the data, we nd that
mobile devices have wider distributions (reecting us-
age at multiple locations and in-motion), while on the
other hand static devices (desktops) have narrow RSSI
distributions and single modes. To extract this feature,
we developed a segmentation algorithm, inspired by the
Median Shift algorithm [24] which infers the number of
local maxima in a distribution, to identify the modes of
the RSSI distribution. We omit a detailed description
of the algorithm due to a lack of space.
This metric is very intuitive and ought to clearly dis-
tinguish device types used in multiple places from those
that are more xed. However, the number of locations
reported is quite low across all devices (at most 3).
Upon close examination, we nd a number of mobile
phones to have single modes, but extremely wide distri-
butions; we believe that natural variations and noise in
7
Compute
Device
Consumer
Electronics
Mobile
Hand-Held
Networking
Equipment
0
10
20
30
40
50
60
70
80
90
(a) rssi_diameter in DC
Game
Console
Net.
Extender
OTT Box PC Printer/
Scanner
Smartphone Tablet
0
5
10
15
20
25
30
35
40
45
(b) rssi_range_80 in DF
Compute
Device
Consumer
Electronics
Mobile
Hand-Held
Networking
Equipment
5000
4000
3000
2000
1000
0
(c) rssi_md in DC
Figure 3: Mobility Related Features
Compute
Device
Consumer
Electronics
Mobile
Hand-Held
Networking
Equipment
0
1
2
3
4
5
6
(a) rssi_ad in DC
Game
Console
Net.
Extender
OTT Box PC Printer/
Scanner
Smartphone Tablet
0
1
2
3
4
5
6
(b) rssi_ad in DF
Figure 4: Distribution of Allan Deviation of RSSI for
dierent device classes: coarse and ne grained cate-
gories
Compute
Device
Consumer
Electronics
Mobile
Hand-Held
Networking
Equipment
0
5
10
15
20
25
30
(a) rssi_area in DC
Game
Console
Net.
Extender
OTT Box PC Printer/
Scanner
Smartphone Tablet
0
5
10
15
20
25
(b) rssi_area in DF
Figure 5: Distribution of RSSI AuC for dierent device
classes: coarse and ne grained categories
the RSSI result in washing out the peaks. To deal with
this, we introduce the next feature.
RSSI AuC: This feature is computed as the area under
the curve of the RSSI distribution. The main intuition
here is that this area captures the degree of in-motion
usage. In order to allow for fair comparisons across dif-
ferent devices (with dierent scales), we normalize the
AuC value by dividing with the absolute maximum fre-
quency. One immediate conclusion is that the higher
the AUC is the more in-motion usage the device has.
Figure 5 shows the distribution of this metric across the
dierent device classes. This feature complements the
Allan Deviation, as it is more resilient to noise. Con-
cretely, a few noisy measurements can have a large value
on the Allan Deviation as computed, especially for de-
vices with short RSSI time series, the impact is less
pronounced on the computed AuC values.
5.2 Feature Analysis
In this section we post-process the features extracted
previously by applying some standard techniques. The
goal here is to transform the features so as to improve
their ability to discriminate between dierent classes,
and thus improve the classication results.
5.2.1 Feature Rescaling
Many statistical models, including the classication
methods that we use in this paper, make implicit as-
sumptions about the data being Gaussian; when this
is not the case, classication performance may be im-
proved by transforming them. We systematically ex-
plored the features to identify those with heavily-skewed
distributions. We use the Extreme Value detector which
proceeds by identifying the fraction of the population
that lies outside a central range. Specically, it la-
bels all the values x, such that Q1 ? EV F ? IQR > x
or x > Q3 + EV F ? IQR. Here Q1 (Q3) are the rst
(third) quartiles, and IQR is the inter-quartile range, i.e.
Q3?Q1. If at least 1% of the values in a particular fea-
ture lies outside this interval, we consider the feature
to be excessively skewed. Table 4 enumerates the 10
most skewed features extracted from our data for EVF=6
(the skewness test is fairly stable and we did not observe
dierent outcomes with EVF in [3, 10]. It is worth not-
ing that all of detected features are skewed only to the
right side of the distributions. In short, the two fea-
ture families of our datasets  trac based, and rssi
based  behave dierently. Distributions constructed
from RSSI based features have a Gaussian shape. On
the other hand, distributions from trac based features
tend to have long tails. This is likely because trac phe-
nomenon are inherently bursty, and devices often have
long inactivity periods during which no trac is gener-
ated.
Consequently, for each attribute identied as skewed,
a logarithmic transformation is applied to rescale the
data. We attach a sux of ln to the rescaled fea-
ture to dierentiate it from the original. For example,
the rebalanced version of session_min is replaced with
session_min_ln.
5.2.2 Feature Reduction
8
Rank Feature Extreme Value %
1 tx_rate_p75 24.82
2 tx_rate_iqr 24.82
3 session_min 13.38
4 session_tx_min 12.58
5 tx_min 12.51
6 tx_rate_range80 12.17
7 tx_rate_p90 12.17
8 rx_rate_p75 11.84
9 rx_rate_iqr 11.81
10 rx_max 10.10
Table 4: Top 10 skewed features
Classication performance is strongly related to the
number of features employed. Looking over the set of
features shown in Table 3, we may expect a certain
level of correlation between some subsets. For example,
it is very likely that the incoming trac volume and
outgoing trac volume are likely to be highly correlated
- since most client end-hosts (rst) request content from
remote servers which is subsequently delivered.
To quantify the extent of redundancy in our dataset,
we carry out a Principal Component Analysis (PCA) [6]
over the feature space. PCA is a well known linear
transformation onto a new orthogonal space which has
the property of concentrating the variance inherent in
the original data. In a PCA transformed space, the
principal components are rank ordered by the fraction of
variance (in the original dataset) accounted for. Thus,
the rst principal component is associated with the largest
amount of variance; each succeeding component has the
highest remaining variance and under the constraint
that it is orthogonal to all the previous components.
Figure 6 plots the cumulative variance contribution
of the component axes obtained from a PCA transform.
From the gure we see that all of the variance in the fea-
ture space can be accounted for with roughly 30 compo-
nents, and about 20 components can explain over 95%
of the variance in the data. This indicates that roughly
half of the original features in our dataset are redun-
dant and can be removed without adversely aecting
classier accuracy while at the same time speeding up
the classiers. However, one of the drawbacks of PCA
is that the transformed space (where variance is concen-
trated along orthogonal axes) is not intuitive and does
not inform us as to which features must be selected,
and which can be dropped. What it does give us is a
guideline for how many features should be retained.
Even though the feature space that we are dealing
with is relatively modest, it is still an interesting ex-
cerise to try to reduce the set of features  it provides
some insights into the most important features in the
dataset. If this reduced set of features is small, it might
even be feasible to perform the classication on the
gateways themselves. In this paper, we examine the
reduced feature set, and leave the viability of gateway-
based classication to future work.
 0
 0.2
 0.4
 0.6
 0.8
 1
 1.2
 0  10  20  30  40  50  60  70  80
C
um
m
la
tiv
e 
V
ar
ia
nc
e
Principal Components
Figure 6: Variance captured by principal components.
Coarse-Grain Classes Fine-Grain Classes
rssi_ad rssi_ad
rssi_range80 rssi_range80
rx_rate_p75_ln rx_rate_p75_ln
tx_rate_p90_ln tx_rate_p90_ln
session_rx_p10_ln session_rx_p10_ln
rx_p25_ln rx_p25_ln
rssi_min rssi_p10
session_rx_p25_ln session_p75_ln
session_rx_p75_ln session_max_ln
rx_p90_ln tx_range80_ln
Table 5: List of Top Features, w.r.t Coarse- and Fine-
Grain Classes, Selected using CFS [11]
A number of techniques have been proposed in the lit-
erature towards feature sub-selection. We use a method
known as Correlation-based Feature Selection (CFS) tech-
nique, that is known to produce feature subsets that
generalize well to many dierent classication meth-
ods [11] and which produces a ranking over the fea-
tures. CFS is based on the intuition that the ideal sub-
set of features contain those features that are highly
correlated with the labeled class, and at the same time
poorly correlated with each other. Note that CFS is su-
pervised in that it leverages the label to model feature
dependence and thus, this part of our methodology is
applied on the data (sub)sets DC and DF . Examining
the list of features selected with CFS (Table 5), RSSI-
based features  particularly rssi_ad and rssi_auc) 
and trac rates (both overall and per session) are rated
very highly by CFS.
6. RESULTS
In this section, we briey describe two well known
classication methods and subsequently present detailed
results from applying these classiers on the datasets
DC and dataset DF , and for which we use the labels in-
ferred in Section 4 as the ground truth.
6.1 Classification Methods
In the course of working on this problem, we exper-
imented with several dierent classication algorithms
and techniques of varying complexity. In this paper, we
describe the results from two particular methods  De-
cision Trees and Support Vector Machines (SVM). We
found the SVM based classier to have the best over-
9
all accuracy. However, the results it provides are hard
to interpret in terms of the features are are fed into it.
On the other hand the Decision Tree based classier
yielded slightly lower accuracy, but it provides a frame-
work to reason about the relevance of various features
in classifying a device. We rst report on the overall
results, and later use the results of the Decision Tree to
understand the importance of individual features.
In the earlier stage of our work, we extensively experi-
mented with dierent classication algorithms/techniques
i.e. advanced methods (Neural Networks, Support Vec-
tor Machines, Logistic Regression) as well as more tra-
ditional/simpler methods (Decision Tree, Naive Bayes
and kNN) and at the end chose the following two clas-
siers (one from each group) based on their accuracy,
speed, stability, and readability of results.
•Decision Trees are widely used in multi class classi-
cation applications. Construction starts with one node
containing all the labeled instances and proceeds with
a recursive splitting procedure. The splitting selects
the most discriminative feature (using metrics such as
Gini impurity, information gain, etc.) and partitions
the parent node along the chosen feature. The recursion
proceeds until no more partitioning is possible, and the
tree is subsequently pruned (e.g. using minimal cost-
complexity pruning). Weka implements a number of
decision tree algorithms; we use SimpleCART [4] in our
study. The dening characteristic of this method is that
features are ranked and considered sequentially.
•Support Vector Machines (SVM, for short) are a
family of powerful binary (supervised) classiers which
operate by identifying the boundary or optimal sepa-
rating hyperplane between instances in dierent classes.
One of the salient features of SVMs is the support for
non-linear classication by mapping input data into a
higher dimensional space (i.e., the so called kernel-
trick). They computation in SVMs is to estimate the
parameters of the hyperplane and a number of optimiza-
tion methods have been proposed. In our work, we use
a linear SVM with an implementation that uses the se-
quential minimal optimization (SMO) method [23]. One
important advantage over Decision Trees is that SVMs
can explicitly model dependencies between features.
Parameter Tuning. Both techniques described above
involve a number of parameters (e.g., SVM penalty)
and a key step in employing them eectively is to iden-
tify good parameter values. We use the Weka Machine
Learning framework [10] which includes implementa-
tions for both of these, and which supplies a set of de-
fault parameters that are generally considered good. In
our work, we further use a grid search over the avail-
able parameter space for each classier and identify the
optimal values that maximize classication accuracy.
We compare each classication method against each
other, and against a baseline value that is obtained by
a very trivial classier, ZeroR, which essentially maps
every device instance to the most common class in the
training set. The result of the ZeroR classier serves as
a lower bound the accuracy.
6.2 Overall Results
For evaluation metric, we use the accuracy (dened
as ratio of correctly-classied instances in the test set).
Moreover, the results are based on 10-fold cross-validation
where the data is divided into 10 equally-sized subsets
and the model is trained 10 times, each time using 9 sub-
sets for training and the remaining subset for test.The
nal accuracy is the average of these 10 runs. We also
computed the F-measure metric for the classiers and
found the results to be consistent with accuracy (more
precisely, in almost all cases F-measure is between 1 to
2 percent less than accuracy); we nd the latter more
intuitive to understand and only report on it.
Unless otherwise specied, the results in this section
are shown as the improvement over the ZeroR classi-
er. We report this, and not the absolute value, for
the following reasons. When the dataset is severely un-
balanced (e.g. if a single device class dominates), the
trivial classier can perform as well as the more complex
methods. Reporting the improvement over the trivial
classier  as we do  points to how much better a more
principled classier can do.
6.2.1 Accuracy
In Figures 7a and 7b, we show computed accuracy
for the two classiers and for three distinct feature sets.
The baseline value, i.e., the starting value on the y-axis
is the accuracy as reported by the trivial ZeroR classier
(recall that this corresponds to the population fraction
of the most common device class). The feature subset
all includes all of the features introduced in Table 3,
while CFS:10 and CFS:20 correspond to the scenario
where we only use the top 10 (or 20) features identied
by the CFS algorithm. The accuracy reported corre-
sponds to the optimal parameters (for each classier)
identied by the grid-search discussed previously. We
point out that the improvement over using the default
parameter settings in Weka are small (less than 2% at
most).
Looking at Figure 7a in detail, i.e., accuracy in pre-
dicting coarse grained classes, we nd that both clas-
siers perform quite well even as the SVM has slightly
higher accuracy than the DecisionTree (90.47% as com-
pared to 86.68%). Both classiers do perform signi-
cantly better than the baseline. We suspect this is due
to the fact that two categories are predominant in the
device population and these are also easy to tell apart
with the RSSI based features. Note that reducing the
number of features does not necessarily degrade clas-
10
(a) Coarse-Grained: Dataset DC (b) Fine-Grained: Dataset DF
2 4 6 8 10 12 14
Days in Dataset
20
25
30
35
40
Co
ar
se
 G
ra
ine
d
Dataset DC
Dataset DF  (right)
30
35
40
45
50
55
60
Fin
e G
ra
ine
d
(c) Impact of varying data threshold.
Figure 7: Classication Results
sier accuracy conrming the existence of redundancy
in the feature as well as the eectiveness of the CFS
method (DecisionTree's accuracy is generally less prone
to feature reduction since the top-ranked features are
less likely to be removed). However, we do point out
that the number of features has a very large impact on
the time taken to train the classier and obtain a model.
Turning now to Figure 7b which reports accuracy
numbers when the classiers are applied to the dataset
DF , we nd that the accuracy drops by 6%-7%. As be-
fore the starting value on the y-axis is the accuracy re-
ported by ZeroR. As expected this is lower than in the
previous case  there are more device classes and the
device population is more fragmented. Overall, we see
that the SVM based classier again outperforms Deci-
sionTree (83.11% vs. 77.60%). In comparing the perfor-
mance across the three dierent feature sets shown, we
nd mixed results across the classiers. Overall, the re-
duction in performance due to using a smaller subset of
features is not signicant. The fact that the SVM based
classier consistently performs better than the Decision
Tree (indeed, better than any other classier that we ex-
perimented with) leads us to believe that there is some
amount of coupling between features. Methods that
examine features sequentially (e.g., Decision Trees) or
those that assume independence (e.g., Naive Bayes) are
unable to model this dependence and hence yield lower
accuracies. However, the gains by using a more compli-
cated method like an SVM are modest and this may be
because some device classes are easier to identify than
others.
Understanding this better requires looking at how
well each classier does in identifying individual device
classes. Table 6 presents the confusion matrix that cor-
responds to the SVM classier  we picked the best
performing technique  applied to ne grained data
(dataset DF ). We omit a discussion of the same for
coarse grained labels due to a lack of space. In Ta-
ble 6, the columns are labeled by the letters a through
g, which correspond to the classes indicated on the rows.
We see two patterns emerge from the matrix. First, the
classier often labels smartphones as tablets,2 and vice
2This confusion does not impact the accuracy for the coarse
Classied As ? (a) (b) (c) (d) (e) (f) (g)
Actual Label ?
Smartphone (a) 396 1 8 13 2 1 1
Network/WiFi Ext.(b) 3 76 37 1 0 1 1
Laptop/Desktop (c) 13 6 374 1 0 1 0
Tablet (d) 38 2 7 43 1 0 1
Game Console (e) 13 2 5 3 11 1 0
Printer/Scanner (f) 4 1 2 0 2 2 1
OTT box (g) 0 3 5 2 0 1 3
Table 6: Confusion Matrix: SVM applied to dataset DF
versa. Second, the classier also has diculty clearly
distinguishing PC devices (laptops and desktops) from
network extenders. To rationalize the former, one pos-
sible reason is they really are used in similar ways (note
that we do not have any information about the cellu-
lar activity of the smartphone). It is entirely possible
that a particular individual would use his smartphone
to watch lots of media, and this is what another indi-
vidual uses his tablet device for. Looking at the sec-
ond trend, i.e., the confusion between compute devices
and network extenders, consider that a network exten-
der does not really have a personality of its own, and
simply aggregates many devices behind it. Thus, when
the trac features do match up between these classes
(the distributions for these two entities do overlap as
seen in Fig. 2), they would appear indistinguishable to
the gateway. Furthermore, we manually inspected the
network extenders that are incorrectly labeled as lap-
tops/desktops and noticed that in most, there are a
small number of hostnames associated with the MAC
address (indicating few devices behind the extender).
6.2.2 Data Sufficiency
Most of our features are constructed starting from a
time series of a particular metric. It is then interest-
ing to ask if there is a dependence between observation
time, i.e., the period of time over which the time series
is constructed, and the resulting accuracy in classifying
the device. We reformulate this question to ask: what is
the minimum time duration for a device to be observed
before it is can be classifed to a degree of accuracy?
grained classes since both of these are grouped as Mobile
Handheld devices
11
To consider an extreme example where we use a thresh-
old of 1 day. This implies that a device that has been
active (observed by the gateway) for at least 1 day is
included into the training set. Thus, with a threshold
of 1 day, the training set may include devices active for
just a day or slightly longer. Obviously, the features ex-
tracted from these devices have a lot of variance and are
likely to be misclassied. At the other extreme, if we
were to use a high threshold (say 1 month), we would
reject devices that were active for less than that period.
This reduces the training set and rejects devices that
may be used infrequently.
To nd the right balance and identify the appropri-
ate cut o duration, we ran a set of experiments where
the threshold (number of days a device was active) was
varied. The results for the SVM classier are shown
in Figure 7c. The x-axis indicates the threshold used
(number of days), and the y-axis describes the relative
improvement over the ZeroR classier. For e.g., when
the threshold is 1 day, the accuracy of the SVM clas-
sier is 25% more than the ZeroR classier. As seen
in the gure, there is a initial improvement in the ac-
curacy (around x=4) after which it begins to atten
out. As x increases, two things happen: (i) more de-
vices are rejected from the training set, and (ii) this also
changes the device class distribution. The rejected de-
vices are likely to have been misclassied (so removing
them increases accuracy). Further, as the class distribu-
tion changes, the baseline accuracy also changes, which
further amplies the dierence between the ZeroR clas-
sier and the SVM. The surprising result (for us) was
that a device has to be active for only a few days for it
to be classied accurately. Hence, as a tradeo between
maximum accuracy and maximum dataset size, we have
used the threshold value of 3 in this paper to dene the
transient versus non-transient devices (explained in Sec-
tion 1).
6.3 Incorporating MAC Information
Recall from Section 3.1 that the MAC OUI identies
the manufacturer of the network interface. Manufactur-
ers vary greatly in the number of types of devices that
they manufacture. On one hand, Apple builds devices
that cover all of the coarse grained device classes (and
here the OUI is not likely to possess signicant discrim-
inatory power). On the other hand, Roku manufactures
exactly one type of device  an OTT box; here, the OUI
completely determines the class of device. Most manu-
facturers fall somewhere inside this spectrum and this
can be leveraged to improve the classication accuracy.
It is very important to point out that the correlation
between OUI to category correlation is not a very gen-
eral one. Conceivably, a dierent dataset has contains
predominantly Apple manufactured devicesis unlikely
to benet from the addition of the OUI as a feature.
Since the learned classier function(s) depend greatly
on the distribution of device manufacturers across de-
vices  and this can vary a great deal based on country,
user demographic, etc.  we do not incorporate the OUI
into our core set of features. That being said, examining
its utility inside our specic dataset is interesting.
Figures 8 shows the improvement in classication ac-
curacy for the datasets DC and DF by incorporating the
OUI as categorical feature. Note that we used the entire
set of features here (rather than the subsets extracted
from CFS). The gure clearly shows that the classier
accuracy increases (by more than 10% in the best case).
The improvement is greater for classiers operating on
the ne grained data. To point to an example: the accu-
racy of the SVM increases by about 7% when applied to
ne grained dataset. However, the higher gain in accu-
racy corresponds to the DecisionTree classier. Recall
that this classier recursively splits the data based on
the feature that has the highest (remaining) discrimi-
native power; the OUI is selected early because of the
heterogeneity of OUI's in our dataset. This factor also
cautions against generalizing these results too much; a
dierent dataset with a dierent distribution of manu-
facturers may produce completely dierent results.
6.4 Human-Readable Behavior Inference
While the SVM based classier is the best perform-
ing, the results are hard to interpret and understand
which particular features lead to certain devices being
classied as they are, or their relative importance in de-
ciding on the nal labeling. On the other hand, the De-
cisionTree proceeds by greedily partitioning the dataset
by successively selecting discriminating features. Thus,
the partitioning order directly indicates the relative im-
portance of the associated feature. Note that the indi-
viduals labels generated by DecisionTree might be dif-
ferent from those assigned by SVM; however the per-
formance of the DecisionTree is not very far from the
SVM. Fig. 9 shows a tree generated using SimpleCart.
Here, features (internal nodes) are ordered by the dis-
tance to the root of the tree. In this particular case, the
most important feature is determined to be rssi_ad
(this captures device mobility). Notice that the right
side of the tree, where the feature value is greater than
2.04 only contains leaf nodes relating to Mobile hand
held devices. Knowing that a device has high mobil-
ity is sucient to rule out devices like computers, game
consoles, and OTT boxes, which are typically used in
a few xed locations. The structure of the tree also
provides a few hints that could explain the confusion
between smartphones and tablets as well as PCs and
Network Extenders (cf. Table 6); these appear as sib-
lings in the upper levels of the tree (near the root).
Going further, we seek to understand the essence of
a particular device class and to be able to describe it
12
DecisionTree SVM
0
2
4
6
8
10
12
Ac
cu
ra
cy
 Im
pr
ov
em
en
t
Dataset DC Dataset DF
Figure 8: Impact of incorporating MAC OUI
rssi_ad
< 
tx_rate_p90_ln 
< 0.99
rssi_ad
< 1.08
NoYes
Yes
session_p90_ln 
< 12.12
rssi_auc
< 9.41
network network
Yes
Yes No
No
tx_p90_ln tablet
NoYes
pc
rx_p90_ln 
< 16.09
smartphone
Yes No
< 12.91
game
Yes
network
No
2.04
rssi_ad
< 2.58
tx_p90_ln 
< 19.77
No
No
Yes
smartphone
tablet smartphone
Yes No
Figure 9: Output of SimpleCART on dataset DF
succinctly with a set of concise rules. To state it an-
other way, we wish to uncover what makes a smart-
phone a smartphone, and not a game console. There
are two drawbacks in directly using the decision tree as
constructed previously: (i) a certain class may appear
in several leaf nodes throughout the tree, which con-
founds eorts to describe the classes purely in terms of
a single path from the root of the tree, (ii) more impor-
tantly, minority classes are not captured in the tree (in
our tree, for example Printer/Scanner), as the classier
can aord to ignore them (labeling them incorrectly
degrades accuracy very little). To address this, we em-
ploy the one-versus-all-the-rest approach for individual
classes and use the ConjunctiveRule [25] classier im-
plemented in Weka; this classier learns a simple set of
conjunctions that can be used to predict nominal class
labels. Before we apply it, we need to balance the device
classes and to this end we use a technique called Syn-
thetic Minority Oversampling TEchnique (SMOTE [8]).
This generates new articial instances for the minority
class to make the dataset more balanced. The result
of the ConjunctiveRule learner is described in Table 7,
which roughly correspond to concise behavior descrip-
tors of the device. The table also indicates the accu-
racy that results from using only the induced rule to
dierentiate devices of that class from the rest of the
population. For some ne grained categories, single
features are extremely discriminative; for e.g., rssi_ad
Category Conj. Rule Accuracy
Smartphone rssi_ad > 2.1 89.6
Printer/Scanner tx_p25_ln < 12.71 88.76
Laptop/Desktop tx_rate_p90_ln > 0.70 86.13
Game Console rx_med_ln < 12.5 AND 83.76
tx_rate_max < 14633.1
OTT rx_rate_max < 800 81.61
Network Eqpmt. session_range80_ln > 12.1 AND
session_rx_rate_p10_ln > 1.1 AND 76.01
traffic_days > 25.51
Tablet rssi_ad > 1.2 OR 69.84
session_rx_rate_p75_ln < 4.1)
Table 7: Results of Single Conjunctive Rule Learner
(almost) completely describes smartphones, and thresh-
olding tx_p25_ln completely captures printer/scanner
devices. The latter is rule is quite intuitive since we
expect these devices to be used very rarely, and thus,
would generate low volumes of trac on an average day.
One salient property of these rules is that they can be
used directly on the gateways to carry out a reasonably
good classication of the devices in the home.
7. CONCLUSIONS
In this paper, we described a methodology to iden-
tify the category of a networked device based on on low
level indicators of network activity logged on home in-
ternet gateways. We analyzed in detail a dataset of 240
subscriber homes and extracted a number of features
that succinctly capture the trac and spatial behav-
ior of devices in our dataset. We also dened a two
level taxonomy of device categories (coarse and ne)
and used a number of heuristics on static device descrip-
tors to associate devices with these labels (which were
then extensively checked by manual inspection). We
then experimented with a number of well known classi-
cation methods towards predicting the labels that we
previously obtained. Overall, we nd that the coarse
grained (higher level) label of a class can be inferred
with very high accuracy (91% with the best case SVM
classier), with ne grained labels accurate up to 84%.
We also examined the impact of incorporating mac ad-
dress information into the classication and showed an
accuracy improvement of about 6% (coarse grained) and
8% (ne grained). While these improvements may not
generalize outside of our specic dataset, they provide
useful insights. Moving past just classier performance,
we attempt to understand the relationship between fea-
ture types and individual device classes. To this end, we
construct a set of simple, concise predicate conjunctions
(over the features) that capture the latent character of
each device type. One of the takeaways in our work
is that the high accuracy is realized even with a rela-
tively small feature set, and all of which focus purely
on two aspects of device behavior  how much trac
it exchanges on the network, and its positioning (rel-
ative to the gateway) over time. This was enabled by
13
a detailed dataset exploration and selection of features
that combined intuition with existing best practices. To
highlight one particular case of this: all of the spatial
features rely on the same metric reported from the gate-
way; by extracting various behaviors from this single
metric, we are able to successfully discriminate between
dierent kinds of mobile devices.
Our work is described in the context of an ISP (which
owns and operates the home internet gateway) that
wishes to classify devices in a customer's home. The
model that we envision is that there is an initial of-
ine procedure (with a large training set) carried out
in the ISP's premises to learn the classication models.
Subsequently, gateways periodically report the feature
summaries the ISP where they are run against the se-
lected model(s) after which device labels are sent back
to the gateway. In the future, we plan to investigate
classication methods that can directly be run on the
gateway itself.
8. REFERENCES
[1] D. Allan. Time and frequency (time-domain)
characterization, estimation, and prediction of
precision clocks and oscillators. IEEE Trans. on
Ultrasonics, Ferroelectrics, and Frequency
Control, 34(6):647654, Nov 1987.
[2] S. M. Bellovin. A technique for counting natted
hosts. In IMW, New York, NY, USA, 2002. ACM.
[3] S. Bratus, C. Cornelius, D. Kotz, and D. Peebles.
Active behavioral ngerprinting of wireless
devices. In WiSec, NY, USA, 2008. ACM.
[4] L. Breiman, J. H. Friedman, R. A. Olshen, and
C. J. Stone. Classication and Regression Trees.
Wadsworth International Group, 1984.
[5] http://bit.ly/1fnTjOJ. BT and Phorm: how
an online privacy scandal unfolded.
[6] G. H. Dunteman. Principal components analysis.
Number 69. Sage, 1989.
[7] P. Eckersley. How unique is your web browser? In
International Conference on Privacy Enhancing
Technologies, Berlin, Heidelberg, 2010.
Springer-Verlag.
[8] N. V. C. et. al. Synthetic minority over-sampling
technique. Journal of Articial Intelligence
Research, 16:321357, 2002.
[9] J. Franklin, D. McCoy, P. Tabriz, V. Neagoe,
J. Van Randwyk, and D. Sicker. Passive data link
layer 802.11 wireless device driver ngerprinting.
In USENIX Security Symposium, Berkeley, CA,
USA, 2006. USENIX Association.
[10] M. Hall, E. Frank, G. Holmes, B. Pfahringer,
P. Reutemann, and I. H. Witten. The weka data
mining software: an update. ACM SIGKDD
explorations newsletter, 11(1):1018, 2009.
[11] M. A. Hall. Correlation-based Feature Subset
Selection for Machine Learning. PhD thesis, Univ.
of Waikato, Hamilton, New Zealand, 1998.
[12] Y. Jin, N. Dueld, P. Haner, S. Sen, and Z.-L.
Zhang. Inferring applications at the network layer
using collective trac statistics. In
SIGMETRICS, pages 351352, 2010.
[13] K. Kaemarungsi and P. Krishnamurthy. Analysis
of wlan's received signal strength indication for
indoor location ngerprinting. Pervasive Mob.
Comput., 8(2), Apr. 2012.
[14] T. Karagiannis, K. Papagiannaki, and
M. Faloutsos. Blinc: Multilevel trac
classication in the dark. SIGCOMM CCR, 35(4),
Aug. 2005.
[15] K. Kleisouris, B. Firner, R. Howard, Y. Zhang,
and R. P. Martin. Detecting intra-room mobility
with signal strength descriptors. In MobiHoc,
pages 7180, 2010.
[16] T. Kohno, A. Broido, and K. C. Clay. Remote
physical device ngerprinting. IEEE Trans.
Dependable Secur. Comput., 2(2):93108, Apr.
2005.
[17] http://bit.ly/1Pnea52. MAC address and
Manufacturer name change!
[18] G. Maier, F. Schneider, and A. Feldmann. Nat
usage in residential broadband networks. In PAM,
Berlin, Heidelberg, 2011. Springer-Verlag.
[19] K. Muthukrishnan, B. J. van der Zwaag, and
P. Havinga. Inferring motion and location using
wlan rssi. In MELT, pages 163182, 2009.
[20] T. T. Nguyen and G. Armitage. A survey of
techniques for internet trac classication using
machine learning. Commun. Surveys Tuts.,
10(4):5676, Oct. 2008.
[21] Nmap security scanner. http://www.nmap.org.
[22] J. Pang, B. Greenstein, R. Gummadi, S. Seshan,
and D. Wetherall. 802.11 user ngerprinting. In
MobiCom, pages 99110, New York, NY, USA,
2007. ACM.
[23] J. Platt. Fast training of support vector machines
using sequential minimal optimization. In
B. Schoelkopf, C. Burges, and A. Smola, editors,
Advances in Kernel Methods - Support Vector
Learning. MIT Press, 1998.
[24] L. Shapira, S. Avidan, and A. Shamir.
Mode-detection via median-shift. In ICCV, pages
19091916, 2009.
[25] I. H. Witten and E. Frank. Data Mining:
Practical machine learning tools and techniques.
Morgan Kaufmann, 2005.
14
